<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>My JSP 'index.jsp' starting page</title>
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	-->
  </head>
  
  <body>
    <div align="center" style="background-color: #ff0000">
		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
	            id="ernie" width="690" height="690"
	             codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
	         <param name="movie" value="http://localhost:8080/test/ernie/ernie.swf" />
	         <param name="quality" value="high" />
	         <param name="allowScriptAccess" value="sameDomain" />
	         <param name="wmode" value="transparent" />
	         <param name="flashvars" value="uId=1&aId=1&baseUrl=http://localhost:9090/ernieWgc/ernie/" />
	         <embed src="http://localhost:8080/test/ernie/ernie.swf?uId=1&aId=1&baseUrl=http://localhost:9090/ernieWgc/ernie/" quality="high" wmode="transparent"
	             width="690" height="690" name="ernie" align="middle"
	             play="true" loop="false" quality="high" allowScriptAccess="sameDomain"
	             type="application/x-shockwave-flash"
	             pluginspage="http://www.macromedia.com/go/getflashplayer">
	         </embed>
	     </object>
	     <br/>
	     <div>html调用flash <a href="#" onclick="return sendErnie();">摇奖</a></div>
	 </div>
  </body>
  
  <script type="text/javascript">
  	/**获得flash 对象*/
  	var flashObj = thisMovie("ernie")
  	function thisMovie(movieName) {
		if(navigator.appName.indexOf("Microsoft") != -1){
            return window[movieName];
        } else {
            return document[movieName];
        }
    }
  	
  	/**
  	*向flex发送请求  调用flex方法
  	**/
  	function sendErnie(){
  		flashObj.sendErnie();
  		return false ;
  	}
  	
  	/**
  	*flex 点击领奖按钮调度  调用js
  	* massage ： 消息
  	* url : 跳转路径
  	* target : 跳转目标
  	* 这三个参数是 后台接口的相应数据
  	*/
  	function asCallJsGotoAward(massage,url,target){
  		alert("中奖了\n massage = "+massage+"\nurl="+url+"\ntarget="+target);
  	}

  	/**
  	*后台数据传给flex status != 1  调用  即摇奖失败
  	* massage ： 消息
  	* url : 跳转路径
  	* target : 跳转目标
  	* 这三个参数是 后台接口的相应数据
  	*/
  	function asCallJsErnieFailure(massage,url,target){
  		alert("摇奖错误\n massage = "+massage+"\nurl="+url+"\ntarget="+target);
  	}

  	/**
  	* 将按钮重置为可点击的 调用flex 方法
  	*/
  	function updateSendErnieBtn(){
  		flashObj.updateSendErnieBtn();
  	}
  	
  </script>
</html>